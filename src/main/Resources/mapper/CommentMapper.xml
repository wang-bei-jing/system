<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.zzti.dao.CommentMapper">
  <resultMap id="BaseResultMap" type="edu.zzti.bean.Comment">
    <id column="c_id" jdbcType="INTEGER" property="cId" />
    <result column="c_identity" jdbcType="INTEGER" property="cIdentity" />
    <result column="c_from" jdbcType="VARCHAR" property="cFrom" />
    <result column="c_to" jdbcType="VARCHAR" property="cTo" />
    <result column="c_ts_id" jdbcType="INTEGER" property="cTsId" />
    <result column="c_content" jdbcType="VARCHAR" property="cContent" />
    <result column="c_time" jdbcType="TIMESTAMP" property="cTime" />
    <result column="c_all" jdbcType="INTEGER" property="cAll" />
    <result column="c_status" jdbcType="INTEGER" property="cStatus" />
  </resultMap>

  <!-- xwq分界线开始 -->
  <!-- 关联信息 -->
  <resultMap id="BaseResultMapWith" type="edu.zzti.bean.Comment">
    <id column="c_id" jdbcType="INTEGER" property="cId" />
    <result column="c_identity" jdbcType="INTEGER" property="cIdentity" />
    <result column="c_from" jdbcType="VARCHAR" property="cFrom" />
    <result column="c_to" jdbcType="VARCHAR" property="cTo" />
    <result column="c_ts_id" jdbcType="INTEGER" property="cTsId" />
    <result column="c_content" jdbcType="VARCHAR" property="cContent" />
    <result column="c_time" jdbcType="TIMESTAMP" property="cTime" />
    <result column="c_all" jdbcType="INTEGER" property="cAll" />
    <result column="c_status" jdbcType="INTEGER" property="cStatus" />
    <!-- 关联字段封装 -->
    <association property="topicSelect" javaType="edu.zzti.bean.TopicSelect">
      <id column="tsId" jdbcType="INTEGER" property="id" />
      <result column="s_sno" jdbcType="VARCHAR" property="sSno" />
      <result column="t_tno" jdbcType="INTEGER" property="tTno" />
      <result column="tp_id" jdbcType="INTEGER" property="tpId" />
      <result column="tsStatus" jdbcType="VARCHAR" property="status" />
    </association>
    <!-- 关联字段封装 -->
    <association property="student" javaType="edu.zzti.bean.Student">
      <id column="sno" jdbcType="VARCHAR" property="sno" />
      <result column="password" jdbcType="VARCHAR" property="password" />
      <result column="sName" jdbcType="VARCHAR" property="name" />
      <result column="sex" jdbcType="VARCHAR" property="sex" />
      <result column="tel" jdbcType="VARCHAR" property="tel" />
      <result column="email" jdbcType="VARCHAR" property="email" />
      <result column="sDepartment" jdbcType="VARCHAR" property="department" />
      <result column="classes" jdbcType="VARCHAR" property="classes" />
      <result column="sStatus" jdbcType="INTEGER" property="status" />
    </association>
    <association property="topic" javaType="edu.zzti.bean.Topic">
      <id column="tpId" jdbcType="INTEGER" property="id" />
      <result column="tpName" jdbcType="VARCHAR" property="name" />
      <result column="contents" jdbcType="VARCHAR" property="contents" />
      <result column="tno" jdbcType="INTEGER" property="tno" />
      <result column="type" jdbcType="VARCHAR" property="type" />
      <result column="source" jdbcType="VARCHAR" property="source" />
      <result column="difficulty" jdbcType="VARCHAR" property="difficulty" />
      <result column="support" jdbcType="VARCHAR" property="support" />
      <result column="tpDepartment" jdbcType="VARCHAR" property="department" />
      <result column="tpStatus" jdbcType="INTEGER" property="status" />
      <result column="num" jdbcType="INTEGER" property="num" />
    </association>
  </resultMap>

  <!-- xwq分界线结束 -->
  <sql id="Base_Column_List">
    c_id, c_identity, c_from, c_to, c_ts_id, c_content, c_time, c_all, c_status
  </sql>

<!-- xwq开始 -->
  <select id="selectPeople" parameterType="java.lang.String" resultMap="BaseResultMapWith">
    select DISTINCT t_comment.c_from,t_comment.c_to
    from t_comment
    where (t_comment.c_from = #{id,jdbcType=VARCHAR} or t_comment.c_to = #{id,jdbcType=VARCHAR} )
	order by t_comment.c_time DESC
  </select>
  <select id="selectByTwo" parameterType="java.lang.String" resultMap="BaseResultMapWith">
   select *,t_topicselect.id tsId,t_topicselect.status tsStatus,t_student.name sName,t_student.department sDepartment,t_student.status sStatus,t_topic.id tpId,t_topic.name tpName,t_topic.department tpDepartment,t_topic.status tpStatus
    from t_comment,t_topicselect,t_student,t_topic
    where t_comment.c_ts_id = t_topicselect.id
    and t_topicselect.s_sno = t_student.sno
    and t_topicselect.tp_id = t_topic.id
    and t_topicselect.status = 1
    and t_comment.c_all = 0
    and (t_comment.c_from = #{one,jdbcType=VARCHAR} or t_comment.c_to = #{one,jdbcType=VARCHAR})
    and (t_comment.c_from = #{two,jdbcType=VARCHAR} or t_comment.c_to = #{two,jdbcType=VARCHAR} )
    order by t_comment.c_time
  </select>
  <select id="selectAll" parameterType="java.lang.String" resultMap="BaseResultMapWith">
   select *,t_topicselect.id tsId,t_topicselect.status tsStatus,t_student.name sName,t_student.department sDepartment,t_student.status sStatus,t_topic.id tpId,t_topic.name tpName,t_topic.department tpDepartment,t_topic.status tpStatus
    from t_comment,t_topicselect,t_student,t_topic
    where t_comment.c_ts_id = t_topicselect.id
    and t_topicselect.s_sno = t_student.sno
    and t_topicselect.tp_id = t_topic.id
    and t_topicselect.status = 1
    and t_comment.c_all = 0
    and (t_comment.c_from = #{id,jdbcType=VARCHAR} or t_comment.c_to = #{id,jdbcType=VARCHAR})
    order by t_comment.c_time
  </select>
  <!-- xwq结束 -->

  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from t_comment
    where c_id = #{cId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    delete from t_comment
    where c_id = #{cId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="edu.zzti.bean.Comment">
    insert into t_comment (c_id, c_identity, c_from, 
      c_to, c_ts_id, c_content, 
      c_time, c_all, c_status
      )
    values (#{cId,jdbcType=INTEGER}, #{cIdentity,jdbcType=INTEGER}, #{cFrom,jdbcType=VARCHAR}, 
      #{cTo,jdbcType=VARCHAR}, #{cTsId,jdbcType=INTEGER}, #{cContent,jdbcType=VARCHAR}, 
      #{cTime,jdbcType=TIMESTAMP}, #{cAll,jdbcType=INTEGER}, #{cStatus,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="edu.zzti.bean.Comment">
    insert into t_comment
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="cId != null">
        c_id,
      </if>
      <if test="cIdentity != null">
        c_identity,
      </if>
      <if test="cFrom != null">
        c_from,
      </if>
      <if test="cTo != null">
        c_to,
      </if>
      <if test="cTsId != null">
        c_ts_id,
      </if>
      <if test="cContent != null">
        c_content,
      </if>
      <if test="cTime != null">
        c_time,
      </if>
      <if test="cAll != null">
        c_all,
      </if>
      <if test="cStatus != null">
        c_status,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="cId != null">
        #{cId,jdbcType=INTEGER},
      </if>
      <if test="cIdentity != null">
        #{cIdentity,jdbcType=INTEGER},
      </if>
      <if test="cFrom != null">
        #{cFrom,jdbcType=VARCHAR},
      </if>
      <if test="cTo != null">
        #{cTo,jdbcType=VARCHAR},
      </if>
      <if test="cTsId != null">
        #{cTsId,jdbcType=INTEGER},
      </if>
      <if test="cContent != null">
        #{cContent,jdbcType=VARCHAR},
      </if>
      <if test="cTime != null">
        #{cTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cAll != null">
        #{cAll,jdbcType=INTEGER},
      </if>
      <if test="cStatus != null">
        #{cStatus,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="edu.zzti.bean.Comment">
    update t_comment
    <set>
      <if test="cIdentity != null">
        c_identity = #{cIdentity,jdbcType=INTEGER},
      </if>
      <if test="cFrom != null">
        c_from = #{cFrom,jdbcType=VARCHAR},
      </if>
      <if test="cTo != null">
        c_to = #{cTo,jdbcType=VARCHAR},
      </if>
      <if test="cTsId != null">
        c_ts_id = #{cTsId,jdbcType=INTEGER},
      </if>
      <if test="cContent != null">
        c_content = #{cContent,jdbcType=VARCHAR},
      </if>
      <if test="cTime != null">
        c_time = #{cTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cAll != null">
        c_all = #{cAll,jdbcType=INTEGER},
      </if>
      <if test="cStatus != null">
        c_status = #{cStatus,jdbcType=INTEGER},
      </if>
    </set>
    where c_id = #{cId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="edu.zzti.bean.Comment">
    update t_comment
    set c_identity = #{cIdentity,jdbcType=INTEGER},
      c_from = #{cFrom,jdbcType=VARCHAR},
      c_to = #{cTo,jdbcType=VARCHAR},
      c_ts_id = #{cTsId,jdbcType=INTEGER},
      c_content = #{cContent,jdbcType=VARCHAR},
      c_time = #{cTime,jdbcType=TIMESTAMP},
      c_all = #{cAll,jdbcType=INTEGER},
      c_status = #{cStatus,jdbcType=INTEGER}
    where c_id = #{cId,jdbcType=INTEGER}
  </update>
</mapper>